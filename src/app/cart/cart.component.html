<div class="cart-container">
  <div class="cart-header">
    <h1>üõí Gi·ªè H√†ng</h1>
    <p *ngIf="cartItems.length === 0" class="empty-cart">Gi·ªè h√†ng c·ªßa b·∫°n tr·ªëng</p>
  </div>

  <div *ngIf="loading" class="loading">
    <p>ƒêang t·∫£i gi·ªè h√†ng...</p>
  </div>

  <div *ngIf="!loading && cartItems.length > 0" class="cart-content">
    <div class="cart-items">
      <mat-card *ngFor="let item of cartItems; let i = index" class="cart-item">
        <div class="item-image">
          <img [src]="item.src?.medium || item.src?.large || item.image || '/assets/placeholder.svg'" 
               [alt]="item.title || item.alt || 'S·∫£n ph·∫©m'" 
               onError="this.src='/assets/placeholder.svg'" />
        </div>

        <div class="item-details">
          <h3>{{ item.title || item.alt || 'S·∫£n ph·∫©m' }}</h3>
          <p class="price">{{ item.price | currency: 'VND' }}</p>
        </div>

        <div class="item-quantity">
          <label [for]="'qty-' + i">S·ªë l∆∞·ª£ng:</label>
          <input
            type="number"
            [id]="'qty-' + i"
            [(ngModel)]="item.quantity"
            (change)="updateQuantity(i, item.quantity)"
            min="1"
            max="100"
          />
        </div>

        <div class="item-total">
          <p>{{ item.price * item.quantity | currency: 'VND' }}</p>
        </div>

        <button
          mat-icon-button
          class="delete-btn"
          (click)="removeItem(i)"
          title="X√≥a kh·ªèi gi·ªè"
        >
          <mat-icon>delete</mat-icon>
        </button>
      </mat-card>
    </div>

    <div class="cart-summary">
      <mat-card class="summary-card">
        <h3>T√≥m T·∫Øt ƒê∆°n H√†ng</h3>

        <div class="summary-row">
          <span>T·ªïng s·∫£n ph·∫©m:</span>
          <span class="value">{{ itemCount }}</span>
        </div>

        <div class="summary-row">
          <span>T·ªïng c·ªông:</span>
          <span class="value total">{{ total | currency: 'VND' }}</span>
        </div>

        <div class="actions">
          <button
            mat-raised-button
            class="checkout-btn"
            (click)="checkout()"
          >
            <mat-icon>payment</mat-icon>
            Thanh To√°n
          </button>

          <button
            mat-raised-button
            class="clear-btn"
            (click)="clearCart()"
          >
            <mat-icon>delete_sweep</mat-icon>
            X√≥a To√†n B·ªô
          </button>
        </div>
      </mat-card>
    </div>
  </div>
</div>
